<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link type="text/css" rel="stylesheet" href="contrib/bootstrap/css/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="contrib/bootstrap/css/bootstrap-theme.min.css">
    <link type="text/css" rel="stylesheet" href="css/slide.css">
    <link type="text/css" rel="stylesheet" href="css/charts.css">
    <script type="text/javascript" src="contrib/d3/d3.v3.min.js"></script>
    <script type="text/javascript" src="contrib/jquery/jquery-2.0.3.min.js"></script>
    <script type="text/javascript" src="js/my-slide.js"></script>
  </head>
  <body>
    <div id="slide">
      <div id="header">
          <h1>The Task</h1>
      </div>
      <div id="content-frame" class='with-only-head'>
        <div id="content">
          <div id="chart"></div>
        </div>
      </div>
    </div>
    <script type="text/javascript">
var i;

var width = 900,
    height = 550;

var margins = [10, 0, 100, 0],
    mb = margins[0],
    ml = margins[1],
    mt = margins[2],
    mr = margins[3],
    w = width - (ml + mr),
    h = height - (mb + mt);

var x = d3.scale.linear()
  .domain([0, 5])
  .range([0, w]);
var y = d3.scale.linear()
  .domain([0,3])
  .rangeRound([0, h]);

var bigx = d3.scale.linear()
  .domain([0,1])
  .range([0,h]);
var bigy = d3.scale.linear()
  .domain([0,1])
  .range([0,h]);

// FIXME Left off about to implement dots in large screen than can be scaled down

var lineDemo = d3.select("#chart")
  .append("svg:svg")
  .attr("width", width)
  .attr("height", height);

var plot = lineDemo.append('g')
  .attr('id','plot')
  .attr('transform','translate('+ml+','+mt+')');

var trial_segs = [
{name: 'Fixation', dur: '2 s', dur2: '', fix_col: 'white'},
{name: 'Sample', dur: '2 s', dur2: '', fix_col: 'white'},
{name: 'Delay', dur: '12 s', dur2: '', fix_col: 'white'},
{name: 'Probe', dur: '(CW/CCW?)', dur2: '1 s', fix_col: 'white'},
{name: 'Feedback', dur: '1 s', dur2: '', fix_col: 'red'},
{name: 'ITI', dur: '5/7/9 s', dur2: '', fix_col: 'gray'},
];

var segs = plot.selectAll('g.trial-seg')
    .data(trial_segs)
  .enter().append('g')
    .attr('class','trial-seg')
    .attr('transform',function(d,i) { 
      return 'translate('+x(i*4/5) + ',' + y(i/3) +')';
    });


// Trial screen rects
segs.append('svg:rect')
  .attr('class','trial-screen')
  .attr('x',0)
  .attr('y',0)
  .attr('rx',10)
  .attr('ry',10)
  .attr('width',x(1))
  .attr('height',y(1))
  .style('fill','black')
  .style('stroke','gray')
  .style('stroke-width','2px');

// Trial fixation
segs.append('svg:line')
  .attr('class','trial-fix')
  .style('stroke',function(d) { return d.fix_col;})
  .style('stroke-width','4px')
  .attr('x1',x(.5-.09))
  .attr('x2',x(.5+.09))
  .attr('y1',y(.5))
  .attr('y2',y(.5));

segs.append('svg:line')
  .attr('class','trial-fix')
  .style('stroke',function(d) { return d.fix_col;})
  .style('stroke-width','4px')
  .attr('x1',x(.5))
  .attr('x2',x(.5))
  .attr('y1',y(.5-.1))
  .attr('y2',y(.5+.1));

// FIXME Add left align style
segs.append('svg:text')
  .attr('class','trial-name')
  .style('text-anchor','start')
  .text(function(d) { return d.name; })
  .attr('y',y(1))
  .attr('dy','1.25em');

// FIXME Remove this is duration can be combined with name and line wrapped
segs.append('svg:text')
  .attr('class','trial-name')
  .style('text-anchor','start')
  .text(function(d) { return d.dur; })
  .attr('y',y(1))
  .attr('dy','2.25em');

segs.append('svg:text')
  .attr('class','trial-name')
  .style('text-anchor','start')
  .text(function(d) { return d.dur2; })
  .attr('y',y(1))
  .attr('dy','3.25em');



var up = function up() {
  var tmp = off;
  off = on;
  on = tmp;
  lineDemo.selectAll(".data")
    .style("stroke",on);
};

var down = function down() {
      up();
};
    </script>
    <script type="text/javascript" src="contrib/bootstrap/js/bootstrap.min.js"></script>
  </body>
</html>
