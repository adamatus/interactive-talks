<!DOCTYPE HTML>
<html>
<head>
    <title>MotionWM Predictions</title>

    <link type="text/css" rel="stylesheet" href="css/slide.css">
    <link type="text/css" rel="stylesheet" href="css/xkcd.css">
    <script type="text/javascript" src="contrib/d3/d3.v3.min.js"></script>
    <script type="text/javascript" src="js/xkcd.js"></script>
</head>
<body>
    <div id="slide">
        <div id="header">
            <h1>Temporal Generalization</h1>
        </div>
      <div id="content-frame" class='with-only-head'>
          <div id="content">
            <!-- Insert chart here -->
    <script>

        // Generate some data.
        function f1 (x) {
            return Math.exp(-0.5 * (x - 1) * (x - 1)) * Math.sin(x + 0.2) + 0.05;
        }

        function f2 (x) {
            return 0.5 * Math.cos(x - 0.5) + 0.1;
        }

        var xmin = -1.0,
            xmax = 7,
            N = 100,
            //data = d3.range(xmin, xmax, (xmax - xmin) / N).map(function (d) {
            //    return {x: d, y: f1(d)};
            //})
            //data2 = d3.range(xmin, xmax, (xmax - xmin) / N).map(function (d) {
            //    return {x: d, y: f2(d)};
            //});
            chance = [{x:0.3, y:0.25},
                    {x:1, y:0.25},
                    {x:2, y:0.25},
                    {x:3, y:0.25},
                    {x:4, y:0.25},
                    {x:5, y:0.25},
                    {x:6, y:0.25},
                    {x:7, y:0.25},
                    {x:8, y:0.25},
                    {x:9, y:0.25},
                    {x:10, y:0.25},
                    {x:11, y:0.25},
                    {x:12, y:0.25}];
            sample_steady = [{x:0.3, y:0.27},
                    {x:1, y:0.23},
                    {x:2, y:0.28},
                    {x:3, y:0.63},
                    {x:4, y:0.85},
                    {x:5, y:0.87},
                    {x:6, y:0.88},
                    {x:7, y:0.86},
                    {x:8, y:0.85},
                    {x:9, y:0.86},
                    {x:10, y:0.83},
                    {x:11, y:0.33},
                    {x:12, y:0.22}],
            sample_falling = [{x:0.3, y:0.27},
                    {x:1, y:0.23},
                    {x:2, y:0.28},
                    {x:3, y:0.63},
                    {x:4, y:0.85},
                    {x:5, y:0.84},
                    {x:6, y:0.54},
                    {x:7, y:0.33},
                    {x:8, y:0.26},
                    {x:9, y:0.24},
                    {x:10, y:0.25},
                    {x:11, y:0.27},
                    {x:12, y:0.25}],
            probe_steady = [{x:0.3, y:0.27},
                    {x:1, y:0.23},
                    {x:2, y:0.28},
                    {x:3, y:0.63},
                    {x:4, y:0.85},
                    {x:5, y:0.87},
                    {x:6, y:0.88},
                    {x:7, y:0.86},
                    {x:8, y:0.85},
                    {x:9, y:0.83},
                    {x:10, y:0.84},
                    {x:11, y:0.3},
                    {x:12, y:0.22}],
            probe_raising = [{x:0.3, y:0.27},
                    {x:1, y:0.23},
                    {x:2, y:0.26},
                    {x:3, y:0.27},
                    {x:4, y:0.33},
                    {x:5, y:0.57},
                    {x:6, y:0.68},
                    {x:7, y:0.79},
                    {x:8, y:0.83},
                    {x:9, y:0.84},
                    {x:10, y:0.85},
                    {x:11, y:0.3},
                    {x:12, y:0.26}];

        // Build the plot.
        var plot = xkcdplot();
        plot("#content");

        // Add the lines.
        plot.plot(chance, {classed:'chance',stroke: 'gray', 'stroke-dasharray':'8 8'});
        plot.plot(sample_steady, {classed:'sample',stroke: "#1A9641"});
        plot.plot(probe_raising, {classed:'probe',stroke: "#5E3C99"});

        // Render the image.
        plot.xlim([-1, 12]);
        plot.ylim([-.25, 1]);
        plot.ylabel(["Direction","Decoding","Accuracy"]);
        plot.xlabel('Trial Time Point');
        plot.title('');
        plot.draw();

        d3.selectAll('.probe').style('opacity',0);
        d3.selectAll('.sample').style('opacity',0);
        d3.select('svg g').append('svg:rect').style('fill','#1A9641').style('opacity',.4).attr('height',450).attr('width',40).attr('x',258).attr('y',0).attr('id','sample-mark').style('opacity',0);
        d3.select('svg g').append('svg:rect').style('fill','#5E3C99').style('opacity',.4).attr('height',450).attr('width',40).attr('x',598).attr('y',0).attr('id','probe-mark').style('opacity',0);

var step = 0;
var maxStep = 5;
// FIXME: Add single TR result, step through timepoints

var up = function(prevSlide) {
    prevSlide = typeof prevSlide !== 'undefined' ? prevSlide : false;

    if (step === 0) {
        if (prevSlide) window.parent.navigateBack();
    } else {
        step = step > 0 ? step-1 : 0;
        if (step == 0)
        {
            d3.selectAll('#sample-mark').transition().duration(500).style('opacity',0);
        } else if (step == 1) {
            d3.selectAll('.sample').transition().duration(500).style('opacity',0);
        } else if (step == 2) {
            plot.transition(sample_steady,{classed:'sample'});
        } else if (step == 3) {
            d3.selectAll('#probe-mark').transition().duration(500).style('opacity',0);
        } else if (step == 4) {
            d3.selectAll('.probe').transition().duration(500).style('opacity',0);
        } else if (step == 5) {
            plot.transition(probe_raising,{classed:'probe'});
            plot.transition(sample_falling,{classed:'sample'});
        }
    }
}

var down = function(nextSlide) {
    nextSlide = typeof nextSlide !== 'undefined' ? nextSlide : false; 

    if (step < maxStep) {
        step = step < maxStep ? step+1 : maxStep;
        if (step == 1)
        {
            d3.selectAll('#sample-mark').transition().duration(500).style('opacity',.4);
        } else if (step == 2) {
            d3.selectAll('.sample').transition().duration(500).style('opacity',1);
        } else if (step == 3) {
            plot.transition(sample_falling,{classed:'sample'});
        } else if (step == 4) {
            d3.selectAll('#probe-mark').transition().duration(500).style('opacity',.4);
        } else if (step == 5) {
            d3.selectAll('.probe').transition().duration(500).style('opacity',1);
        } else if (step == 6) {
            plot.transition(probe_steady,{classed:'probe'});
            plot.transition(sample_steady,{classed:'sample'});
        }
    } else {
        if (nextSlide) window.parent.navigateForward(); 
    }
};

    </script>
    <script type="text/javascript" src="js/my-slide.js"></script>
          </div>
      </div>
   </div>
</body>
</html>
